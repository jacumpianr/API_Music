openapi: 3.0.3
info:
  title: Music_API
  version: "1.0.0"
  description: >
    API REST para gestionar artistas, álbumes y canciones.
    Documentación generada para ReDoc.
servers:
  - url: http://localhost:3000
tags:
  - name: Artistas
    description: Gestión de cantantes y bandas
  - name: Albumes
    description: Gestión de discos y portadas
  - name: Canciones
    description: Gestión de pistas de audio
paths:
  /artistas:
    get:
      summary: Obtener todos los artistas
      tags:
        - Artistas
      x-codeSamples:
        - lang: JavaScript
          label: JS (fetch)
          source: |
            fetch("http://localhost:3000/artistas")
              .then(res => res.json())
              .then(console.log);
        - lang: cURL
          label: cURL
          source: curl -X GET http://localhost:3000/artistas
      responses:
        '200':
          description: Lista de artistas recuperada exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Artista'
        '500':
          description: Error interno del servidor
    post:
      summary: Crear un artista
      tags:
        - Artistas
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - Nombre
                - Nacionalidad
                - FechaNacimientos
              properties:
                Nombre:
                  type: string
                Nacionalidad:
                  type: string
                FechaNacimientos:
                  type: string
                  format: date
                Fotografia:
                  type: string
                  format: binary
      x-codeSamples:
        - lang: JavaScript
          label: JS (FormData)
          source: |
            const fd = new FormData();
            fd.append("Nombre", "Alejandra");
            fd.append("Fotografia", fileInput.files[0]);
            fetch("http://localhost:3000/artistas", { method: "POST", body: fd });
        - lang: cURL
          label: cURL
          source: |
            curl -X POST http://localhost:3000/artistas \
              -F "Nombre=Alejandra" -F "Fotografia=@foto.jpg"
      responses:
        '201':
          description: Artista creado correctamente
        '400':
          description: Datos inválidos
  /artistas/{id}:
    get:
      summary: Obtener un artista por ID
      tags:
        - Artistas
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Detalle del artista
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Artista'
        '404':
          description: Artista no encontrado
    put:
      summary: Actualizar un artista (Completo)
      tags:
        - Artistas
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Nombre:
                  type: string
                Nacionalidad:
                  type: string
                Fotografia:
                  type: string
                  format: binary
      x-codeSamples:
        - lang: JavaScript
          label: JS
          source: |
            const fd = new FormData();
            fd.append("Nombre", "Nuevo");
            fetch("http://localhost:3000/artistas/1", { method: "PUT", body: fd });
        - lang: cURL
          label: cURL
          source: curl -X PUT http://localhost:3000/artistas/1 -F "Nombre=Nuevo"
      responses:
        '200':
          description: Artista actualizado
    patch:
      summary: Actualizar parcialmente un artista
      tags:
        - Artistas
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Nombre:
                  type: string
                Nacionalidad:
                  type: string
      x-codeSamples:
        - lang: JavaScript
          label: JS
          source: |
            const fd = new FormData();
            fd.append("Nacionalidad", "USA");
            fetch("http://localhost:3000/artistas/1", { method: "PATCH", body: fd });
        - lang: cURL
          label: cURL
          source: curl -X PATCH http://localhost:3000/artistas/1 -F "Nacionalidad=USA"
      responses:
        '200':
          description: Actualizado parcialmente
    delete:
      summary: Eliminar un artista
      tags:
        - Artistas
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Artista eliminado
  /albumes:
    get:
      summary: Obtener todos los álbumes
      tags:
        - Albumes
      x-codeSamples:
        - lang: JavaScript
          label: JS
          source: fetch("http://localhost:3000/albumes").then(r=>r.json());
        - lang: cURL
          label: cURL
          source: curl http://localhost:3000/albumes
      responses:
        '200':
          description: Lista de álbumes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Album'
    post:
      summary: Crear un álbum
      tags:
        - Albumes
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - Titulo
                - IdArtista
              properties:
                Titulo:
                  type: string
                FechaLanzamiento:
                  type: string
                  format: date
                IdArtista:
                  type: integer
                Portada:
                  type: string
                  format: binary
      x-codeSamples:
        - lang: JavaScript
          label: JS
          source: |
            const fd = new FormData();
            fd.append("Titulo", "Nuevo Album");
            fd.append("IdArtista", "1");
            fetch("http://localhost:3000/albumes", { method: "POST", body: fd });
        - lang: cURL
          label: cURL
          source: curl -X POST http://localhost:3000/albumes -F "Titulo=X" -F "IdArtista=1"
      responses:
        '201':
          description: Álbum creado
  /albumes/{id}:
    get:
      summary: Obtener un álbum por ID
      tags:
        - Albumes
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Detalle del álbum
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Album'
        '404':
          description: No encontrado
    put:
      summary: Actualizar un álbum (Completo)
      tags:
        - Albumes
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Titulo:
                  type: string
                IdArtista:
                  type: integer
                Portada:
                  type: string
                  format: binary
      x-codeSamples:
        - lang: JavaScript
          label: JS
          source: |
            const fd = new FormData();
            fd.append("Titulo", "Update");
            fetch("http://localhost:3000/albumes/1", { method: "PUT", body: fd });
        - lang: cURL
          label: cURL
          source: curl -X PUT http://localhost:3000/albumes/1 -F "Titulo=Update"
      responses:
        '200':
          description: Actualizado
    patch:
      summary: Actualizar parcialmente un álbum
      tags:
        - Albumes
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Titulo:
                  type: string
                Portada:
                  type: string
                  format: binary
      x-codeSamples:
        - lang: JavaScript
          label: JS
          source: |
            const fd = new FormData();
            fd.append("Titulo", "Partial");
            fetch("http://localhost:3000/albumes/1", { method: "PATCH", body: fd });
        - lang: cURL
          label: cURL
          source: curl -X PATCH http://localhost:3000/albumes/1 -F "Titulo=Partial"
      responses:
        '200':
          description: Actualizado parcialmente
    delete:
      summary: Eliminar un álbum
      tags:
        - Albumes
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Eliminado
  /canciones:
    get:
      summary: Obtener todas las canciones
      tags:
        - Canciones
      x-codeSamples:
        - lang: JavaScript
          label: JS
          source: fetch("http://localhost:3000/canciones").then(r=>r.json());
        - lang: cURL
          label: cURL
          source: curl http://localhost:3000/canciones
      responses:
        '200':
          description: Lista de canciones
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Cancion'
    post:
      summary: Crear una canción (Subir audio)
      tags:
        - Canciones
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - Titulo
                - IdAlbum
                - ArchivoAudio
              properties:
                Titulo:
                  type: string
                Duracion:
                  type: string
                IdAlbum:
                  type: integer
                ArchivoAudio:
                  type: string
                  format: binary
      x-codeSamples:
        - lang: JavaScript
          label: JS
          source: |
            const fd = new FormData();
            fd.append("Titulo", "Song A");
            fd.append("IdAlbum", "1");
            fetch("http://localhost:3000/canciones", { method: "POST", body: fd });
        - lang: cURL
          label: cURL
          source: curl -X POST http://localhost:3000/canciones -F "Titulo=A" -F "ArchivoAudio=@s.mp3"
      responses:
        '201':
          description: Canción creada
  /canciones/{id}:
    get:
      summary: Obtener una canción por ID
      tags:
        - Canciones
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Detalles de la canción
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cancion'
        '404':
          description: No encontrada
    put:
      summary: Actualizar una canción (Completo)
      tags:
        - Canciones
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Titulo:
                  type: string
                Duracion:
                  type: string
                IdAlbum:
                  type: integer
                ArchivoAudio:
                  type: string
                  format: binary
      x-codeSamples:
        - lang: JavaScript
          label: JS
          source: |
            // ...setup FormData...
            fetch("http://localhost:3000/canciones/1", { method: "PUT", body: fd });
        - lang: cURL
          label: cURL
          source: curl -X PUT http://localhost:3000/canciones/1 -F "Titulo=B"
      responses:
        '200':
          description: Actualizada
    patch:
      summary: Actualizar parcialmente una canción
      tags:
        - Canciones
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Titulo:
                  type: string
                Duracion:
                  type: string
      x-codeSamples:
        - lang: JavaScript
          label: JS
          source: |
            const fd = new FormData();
            fd.append("Titulo", "Corrigiendo título");
            fetch("http://localhost:3000/canciones/1", { method: "PATCH", body: fd });
        - lang: cURL
          label: cURL
          source: curl -X PATCH http://localhost:3000/canciones/1 -F "Titulo=New"
      responses:
        '200':
          description: Actualizada parcialmente
    delete:
      summary: Eliminar una canción
      tags:
        - Canciones
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Eliminada
components:
  schemas:
    Artista:
      type: object
      properties:
        id:
          type: integer
          example: 1
        Nombre:
          type: string
          example: Alejandra Guzmán
        Nacionalidad:
          type: string
          example: México
        FechaNacimientos:
          type: string
          format: date
          example: '1968-02-09'
        Fotografia:
          type: string
          description: URL relativa de la imagen
          example: /uploads/artistas/foto_1.jpg
    Album:
      type: object
      properties:
        id:
          type: integer
          example: 10
        Titulo:
          type: string
          example: Flor de Papel
        FechaLanzamiento:
          type: string
          format: date
          example: '1991-10-15'
        IdArtista:
          type: integer
          description: FK a Artista
          example: 1
        Portada:
          type: string
          description: URL relativa de la portada
          example: /uploads/albumes/portada_10.jpg
    Cancion:
      type: object
      properties:
        id:
          type: integer
          example: 45
        Titulo:
          type: string
          example: Hacer el amor con otro
        Duracion:
          type: string
          example: '04:38'
        IdAlbum:
          type: integer
          description: FK a Album
          example: 10
        ArchivoAudio:
          type: string
          description: URL relativa del audio
          example: /uploads/canciones/audio_45.mp3