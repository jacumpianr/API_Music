openapi: 3.0.3
info:
  title: Music_API
  version: "1.0.0"
  description: >
    API REST para gestionar artistas, álbumes y canciones.
  contact:
    name: Soporte API
servers:
  - url: http://localhost:3000

tags:
  - name: Artistas
    description: Gestión de cantantes y bandas
  - name: Albumes
    description: Gestión de discos y portadas
  - name: Canciones
    description: Gestión de pistas de audio

# -------------------------------------------------------------------
# SECCIÓN PATHS (RUTAS)
# -------------------------------------------------------------------
paths:
  /artistas:
    get:
      summary: Obtener todos los artistas
      tags: [Artistas]
      x-codeSamples:
        - lang: JavaScript
          label: JS (fetch)
          source: fetch("http://localhost:3000/artistas").then(r => r.json());
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Artista'
    post:
      summary: Crear un artista
      tags: [Artistas]
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [Nombre, Nacionalidad, FechaNacimientos]
              properties:
                Nombre:
                  type: string
                Nacionalidad:
                  type: string
                FechaNacimientos:
                  type: string
                  format: date
                Fotografia:
                  type: string
                  format: binary
      responses:
        '201':
          description: Creado

  /artistas/{id}:
    get:
      summary: Obtener un artista
      tags: [Artistas]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Detalle
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Artista'
    put:
      summary: Actualizar artista
      tags: [Artistas]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Nombre: { type: string }
                Nacionalidad: { type: string }
                Fotografia: { type: string, format: binary }
      responses:
        '200':
          description: Actualizado
    patch:
      summary: Actualizar parcial
      tags: [Artistas]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Nombre: { type: string }
      responses:
        '200':
          description: Actualizado
    delete:
      summary: Eliminar artista
      tags: [Artistas]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Eliminado

  /albumes:
    get:
      summary: Obtener álbumes
      tags: [Albumes]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Album'
    post:
      summary: Crear álbum
      tags: [Albumes]
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              required: [Titulo, IdArtista]
              properties:
                Titulo: { type: string }
                FechaLanzamiento: { type: string, format: date }
                IdArtista: { type: integer }
                Portada: { type: string, format: binary }
      responses:
        '201':
          description: Creado

  /albumes/{id}:
    get:
      summary: Obtener álbum
      tags: [Albumes]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Detalle
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Album'
    put:
      summary: Actualizar álbum
      tags: [Albumes]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Titulo: { type: string }
                IdArtista: { type: integer }
                Portada: { type: string, format: binary }
      responses:
        '200':
          description: Actualizado
    patch:
      summary: Actualizar parcial
      tags: [Albumes]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Titulo: { type: string }
      responses:
        '200':
          description: Actualizado
    delete:
      summary: Eliminar álbum
      tags: [Albumes]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Eliminado

  /canciones:
    get:
      summary: Obtener canciones
      tags: [Canciones]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Cancion'
    post:
      summary: Subir canción
      tags: [Canciones]
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              required: [Titulo, IdAlbum, ArchivoAudio]
              properties:
                Titulo: { type: string }
                Duracion: { type: string }
                IdAlbum: { type: integer }
                ArchivoAudio: { type: string, format: binary }
      responses:
        '201':
          description: Creado

  /canciones/{id}:
    get:
      summary: Obtener canción
      tags: [Canciones]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Detalle
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cancion'
    put:
      summary: Actualizar canción
      tags: [Canciones]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Titulo: { type: string }
                IdAlbum: { type: integer }
                ArchivoAudio: { type: string, format: binary }
      responses:
        '200':
          description: Actualizado
    patch:
      summary: Actualizar parcial
      tags: [Canciones]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                Titulo: { type: string }
      responses:
        '200':
          description: Actualizado
    delete:
      summary: Eliminar canción
      tags: [Canciones]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Eliminado

# -------------------------------------------------------------------
# AQUÍ ESTÁ EL TRUCO:
# 'components' DEBE estar totalmente a la izquierda (sin espacios)
# -------------------------------------------------------------------
components:
  schemas:
    Artista:
      type: object
      title: Artista
      description: Modelo de datos de un artista musical
      properties:
        id:
          type: integer
          example: 1
        Nombre:
          type: string
          example: Alejandra Guzmán
        Nacionalidad:
          type: string
          example: México
        FechaNacimientos:
          type: string
          format: date
          example: '1968-02-09'
        Fotografia:
          type: string
          example: /uploads/artistas/foto.jpg
    
    Album:
      type: object
      title: Album
      description: Modelo de datos de un disco
      properties:
        id:
          type: integer
          example: 10
        Titulo:
          type: string
          example: Flor de Papel
        FechaLanzamiento:
          type: string
          format: date
          example: '1991-10-15'
        IdArtista:
          type: integer
          example: 1
        Portada:
          type: string
          example: /uploads/portadas/img.jpg

    Cancion:
      type: object
      title: Cancion
      description: Modelo de datos de una pista de audio
      properties:
        id:
          type: integer
          example: 45
        Titulo:
          type: string
          example: Hacer el amor con otro
        Duracion:
          type: string
          example: '04:38'
        IdAlbum:
          type: integer
          example: 10
        ArchivoAudio:
          type: string
          example: /uploads/audio/song.mp3